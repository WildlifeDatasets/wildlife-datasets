
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../reference_analysis/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Splits - Wildlife Datasets</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference-splitting-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Wildlife Datasets" class="md-header__button md-logo" aria-label="Wildlife Datasets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wildlife Datasets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Splits
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/WildlifeDatasets/wildlife-datasets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-datasets
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Wildlife Datasets" class="md-nav__button md-logo" aria-label="Wildlife Datasets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Wildlife Datasets
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/WildlifeDatasets/wildlife-datasets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-datasets
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oveview of datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wildlife_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Displaying datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training ML models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing ML methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding new datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Advanced
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset representation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recommended/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recommended datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../default_splits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default splits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_splits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced splits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary of datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Splits
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Splits
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#balanced-split" class="md-nav__link">
    <span class="md-ellipsis">
      Balanced split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Balanced split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit" class="md-nav__link">
    <span class="md-ellipsis">
      BalancedSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.compute_clusters" class="md-nav__link">
    <span class="md-ellipsis">
      compute_clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.initialize_lcg" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lcg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.modify_df" class="md-nav__link">
    <span class="md-ellipsis">
      modify_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_by_clusters" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_by_clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_by_features" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_by_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_random" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_random
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.set_col_label" class="md-nav__link">
    <span class="md-ellipsis">
      set_col_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identity-split" class="md-nav__link">
    <span class="md-ellipsis">
      Identity split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identity split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.IdentitySplit" class="md-nav__link">
    <span class="md-ellipsis">
      IdentitySplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.IdentitySplit.general_split" class="md-nav__link">
    <span class="md-ellipsis">
      general_split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#closed-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Closed-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Closed-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      ClosedSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Open-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Open-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disjoint-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Disjoint-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disjoint-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      DisjointSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-aware-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-aware split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-aware split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeAwareSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeAwareSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeAwareSplit.modify_df" class="md-nav__link">
    <span class="md-ellipsis">
      modify_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-proportion-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-proportion split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-proportion split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeProportionSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-cutoff-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-cutoff split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-cutoff split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeCutoffSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lcg" class="md-nav__link">
    <span class="md-ellipsis">
      Lcg
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lcg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg" class="md-nav__link">
    <span class="md-ellipsis">
      Lcg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random" class="md-nav__link">
    <span class="md-ellipsis">
      random
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random_permutation" class="md-nav__link">
    <span class="md-ellipsis">
      random_permutation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random_shuffle" class="md-nav__link">
    <span class="md-ellipsis">
      random_shuffle
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#balanced-split" class="md-nav__link">
    <span class="md-ellipsis">
      Balanced split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Balanced split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit" class="md-nav__link">
    <span class="md-ellipsis">
      BalancedSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.compute_clusters" class="md-nav__link">
    <span class="md-ellipsis">
      compute_clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.initialize_lcg" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_lcg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.modify_df" class="md-nav__link">
    <span class="md-ellipsis">
      modify_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_by_clusters" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_by_clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_by_features" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_by_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.resplit_random" class="md-nav__link">
    <span class="md-ellipsis">
      resplit_random
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.set_col_label" class="md-nav__link">
    <span class="md-ellipsis">
      set_col_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.balanced_split.BalancedSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identity-split" class="md-nav__link">
    <span class="md-ellipsis">
      Identity split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identity split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.IdentitySplit" class="md-nav__link">
    <span class="md-ellipsis">
      IdentitySplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.IdentitySplit.general_split" class="md-nav__link">
    <span class="md-ellipsis">
      general_split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#closed-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Closed-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Closed-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      ClosedSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.ClosedSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Open-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Open-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.OpenSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disjoint-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Disjoint-set split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Disjoint-set split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit" class="md-nav__link">
    <span class="md-ellipsis">
      DisjointSetSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.identity_split.DisjointSetSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-aware-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-aware split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-aware split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeAwareSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeAwareSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeAwareSplit.modify_df" class="md-nav__link">
    <span class="md-ellipsis">
      modify_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-proportion-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-proportion split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-proportion split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeProportionSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeProportionSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-cutoff-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-cutoff split
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time-cutoff split">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit" class="md-nav__link">
    <span class="md-ellipsis">
      TimeCutoffSplit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.time_aware_split.TimeCutoffSplit.split" class="md-nav__link">
    <span class="md-ellipsis">
      split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lcg" class="md-nav__link">
    <span class="md-ellipsis">
      Lcg
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lcg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg" class="md-nav__link">
    <span class="md-ellipsis">
      Lcg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random" class="md-nav__link">
    <span class="md-ellipsis">
      random
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random_permutation" class="md-nav__link">
    <span class="md-ellipsis">
      random_permutation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splits.lcg.Lcg.random_shuffle" class="md-nav__link">
    <span class="md-ellipsis">
      random_shuffle
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reference-splitting-functions">Reference splitting functions</h1>
<p>This file describes methods associated with dataset splitting.</p>
<h2 id="balanced-split">Balanced split</h2>


<div class="doc doc-object doc-class">



<a id="splits.balanced_split.BalancedSplit"></a>
    <div class="doc doc-contents first">


        <p>Base class for splitting datasets into training and testing sets.</p>
<p>Implements methods from <a href="https://arxiv.org/abs/2211.10307">this paper</a>.
Its subclasses need to implement the <code>split</code> method.
It should perform balanced splits separately for all classes.
Its children are <code>IdentitySplit</code> and <code>TimeAwareSplit</code>.
<code>IdentitySplit</code> has children <code>ClosedSetSplit</code>, <code>OpenSetSplit</code> and <code>DisjointSetSplit</code>.
<code>TimeAwareSplit</code> has children <code>TimeProportionSplit</code> and <code>TimeCutoffSplit</code>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BalancedSplit</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for splitting datasets into training and testing sets.</span>

<span class="sd">    Implements methods from [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    Its subclasses need to implement the `split` method.</span>
<span class="sd">    It should perform balanced splits separately for all classes.</span>
<span class="sd">    Its children are `IdentitySplit` and `TimeAwareSplit`.</span>
<span class="sd">    `IdentitySplit` has children `ClosedSetSplit`, `OpenSetSplit` and `DisjointSetSplit`.</span>
<span class="sd">    `TimeAwareSplit` has children `TimeProportionSplit` and `TimeCutoffSplit`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">666</span><span class="p">,</span>
        <span class="n">identity_skip</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span><span class="p">,</span>
        <span class="n">col_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;identity&quot;</span><span class="p">,</span>
        <span class="n">disable_tqdm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">identity_skip</span> <span class="o">=</span> <span class="n">identity_skip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">col_label</span> <span class="o">=</span> <span class="n">col_label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disable_tqdm</span> <span class="o">=</span> <span class="n">disable_tqdm</span>

    <span class="k">def</span> <span class="nf">modify_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares dataframe for splits.</span>

<span class="sd">        Removes identities specified in `self.identity_skip` (usually unknown identities).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Modified dataframe of the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_skip</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">initialize_lcg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Lcg</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the random number generator.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The random number generator.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">Lcg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Splitting method which needs to be implemented by subclasses.</span>

<span class="sd">        It splits the dataframe `df` into labels `idx_train` and `idx_test`.</span>
<span class="sd">        The subdataset is obtained by `df.loc[idx_train]` (not `iloc`).</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="p">(</span>
            <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;Subclasses should implement this. </span><span class="se">\n</span><span class="s2"> You may want to use ClosedSetSplit instead of BalancedSplit.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">resplit_random</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">        The re-split mimics the split as the training set contains</span>
<span class="sd">        the same number of samples for EACH individual.</span>
<span class="sd">        The same goes for the testing set.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>
<span class="sd">            idx_train (np.ndarray): Labels of the training set.</span>
<span class="sd">            idx_test (np.ndarray): Labels of the testing set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Initialize the random number generator</span>
        <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

        <span class="c1"># Compute the number of samples for each individual in the training set</span>
        <span class="n">counts_train</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_train</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
            <span class="n">counts_train</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span>
        <span class="c1"># Compute the number of samples for each individual in the testing set</span>
        <span class="n">counts_test</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_test</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
            <span class="n">counts_test</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span>

        <span class="n">idx_train_new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">idx_test_new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over all individuals</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
            <span class="c1"># Extract the number of individuals in the training and testing sets</span>
            <span class="n">n_train</span> <span class="o">=</span> <span class="n">counts_train</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">n_test</span> <span class="o">=</span> <span class="n">counts_test</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The set is too small.&quot;</span><span class="p">))</span>
                <span class="c1"># Get the correct number of indices in both sets</span>
                <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">)</span>
                <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_permutation</span><span class="p">)</span>
                <span class="n">idx_train_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]])</span>
                <span class="n">idx_test_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[</span><span class="n">n_train</span> <span class="p">:</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train_new</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">resplit_by_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">save_clusters_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">        The re-split is based on similarity of features.</span>
<span class="sd">        It runs DBSCAN as described in `compute_clusters` and</span>
<span class="sd">        performs the clustering as described in `resplit_by_clusters`.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">            features (np.ndarray): An array of features with the same length as `df`.</span>
<span class="sd">            idx_train (np.ndarray): Labels of the training set.</span>
<span class="sd">            save_clusters_prefix (Optional[bool], optional): File name prefix for saving clusters.</span>
<span class="sd">            **kwargs (type, optional): See kwargs in `compute_clusters`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_clusters_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">save_clusters_prefix</span><span class="si">}</span><span class="s2">.npy&quot;</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resplit_by_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute_clusters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">n_max_cluster</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">eps_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="n">eps_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span>
        <span class="n">eps_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes clusters for a random re-split of an already existing split.</span>

<span class="sd">        It runs DBSCAN with increasing eps (cluster radius) until</span>
<span class="sd">        the clusters are smaller than `n_max_cluster`.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">            features (np.ndarray): An array of features with the same length as `df`.</span>
<span class="sd">            n_max_cluster (int, optional): Maximal size of cluster before `eps` stops increasing.</span>
<span class="sd">            eps_min (float, optional): Lower bound for epsilon.</span>
<span class="sd">            eps_max (float, optional): Upper bound for epsilon.</span>
<span class="sd">            eps_step (float, optional): Step for epsilon.</span>
<span class="sd">            min_samples (int, optional): Minimal cluster size.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of clusters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_identity</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disable_tqdm</span><span class="p">):</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
            <span class="c1"># Run DBScan with increasing eps until there are no clusters bigger than n_max_cluster</span>
            <span class="n">clusters_saved</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">eps_min</span><span class="p">,</span> <span class="n">eps_max</span> <span class="o">+</span> <span class="n">eps_step</span><span class="p">,</span> <span class="n">eps_step</span><span class="p">):</span>
                <span class="n">clustering</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">)</span>
                <span class="n">clustering</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">clusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
                <span class="n">clusters_counts</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># Check if the largest clusters (without outliers) is not too big</span>
                <span class="k">if</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">clustering_failed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters_counts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n_max_cluster</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">clustering_failed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n_max_cluster</span>
                <span class="c1"># If the largest cluster is not too big, save clustering nad continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">clustering_failed</span><span class="p">:</span>
                    <span class="n">clusters_saved</span> <span class="o">=</span> <span class="n">clusters</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

            <span class="c1"># Save the clusters</span>
            <span class="k">if</span> <span class="n">clusters_saved</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">clusters_saved</span><span class="p">[</span><span class="n">clusters_saved</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters_saved</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">resplit_by_clusters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">clusters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">        The re-split is based on clusters which collect similar images.</span>
<span class="sd">        Then it puts of similar images into the training set.</span>
<span class="sd">        The rest is randomly split into training and testing sets.</span>
<span class="sd">        The re-split mimics the split as the training set contains</span>
<span class="sd">        the same number of samples for EACH individual.</span>
<span class="sd">        The same goes for the testing set.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">            clusters (np.ndarray): An array of clusters with the same length as `df`.</span>
<span class="sd">            idx_train (np.ndarray): Labels of the training set.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Replace clusters appearing just ones with np.nan</span>
        <span class="n">clusters_unique</span><span class="p">,</span> <span class="n">clusters_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">clusters</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">clusters_unique</span><span class="p">[</span><span class="n">clusters_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>

        <span class="c1"># Initialize the random number generator</span>
        <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

        <span class="c1"># Determine how many images of each individual should be in the training set</span>
        <span class="n">identity_train_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_train</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

        <span class="c1"># Loop over individuals and create a split for each</span>
        <span class="n">idx_train_new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">identity</span><span class="p">,</span> <span class="n">df_identity</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disable_tqdm</span><span class="p">):</span>
            <span class="n">n_train</span> <span class="o">=</span> <span class="n">identity_train_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_identity</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_train</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># All or all but one samples into the training set</span>
                <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_shuffle</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">)</span>
                <span class="n">idx_train_identity</span> <span class="o">=</span> <span class="n">idx_remaining</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Add all the clusters into the training set</span>
                <span class="n">idx_train_identity</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_cluster</span> <span class="ow">in</span> <span class="n">df_identity</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">):</span>
                    <span class="c1"># Check if the training set is not too big</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n_train</span><span class="p">:</span>
                        <span class="n">idx_train_identity</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_cluster</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

                <span class="c1"># Distribute the remaining indices</span>
                <span class="n">n_train_remaining</span> <span class="o">=</span> <span class="n">n_train</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span>
                <span class="n">idx_remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setdiff</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">idx_train_identity</span><span class="p">)</span>
                <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_shuffle</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">)</span>
                <span class="n">idx_train_identity</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">[:</span><span class="n">n_train_remaining</span><span class="p">])</span>
            <span class="n">idx_train_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span>
        <span class="n">idx_test_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setdiff</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">idx_train_new</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train_new</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test_new</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_col_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets col_label to desired value</span>

<span class="sd">        Args:</span>
<span class="sd">            col_label (str): Desired value for col_label.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">col_label</span> <span class="o">=</span> <span class="n">col_label</span>

    <span class="k">def</span> <span class="nf">setdiff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.compute_clusters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">n_max_cluster</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">eps_min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">eps_max</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">eps_step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Computes clusters for a random re-split of an already existing split.</p>
<p>It runs DBSCAN with increasing eps (cluster radius) until
the clusters are smaller than <code>n_max_cluster</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>features</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of features with the same length as <code>df</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_max_cluster</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximal size of cluster before <code>eps</code> stops increasing.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps_min</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound for epsilon.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps_max</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound for epsilon.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>eps_step</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Step for epsilon.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_samples</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimal cluster size.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of clusters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_clusters</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">n_max_cluster</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">eps_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">eps_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span>
    <span class="n">eps_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes clusters for a random re-split of an already existing split.</span>

<span class="sd">    It runs DBSCAN with increasing eps (cluster radius) until</span>
<span class="sd">    the clusters are smaller than `n_max_cluster`.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">        features (np.ndarray): An array of features with the same length as `df`.</span>
<span class="sd">        n_max_cluster (int, optional): Maximal size of cluster before `eps` stops increasing.</span>
<span class="sd">        eps_min (float, optional): Lower bound for epsilon.</span>
<span class="sd">        eps_max (float, optional): Upper bound for epsilon.</span>
<span class="sd">        eps_step (float, optional): Step for epsilon.</span>
<span class="sd">        min_samples (int, optional): Minimal cluster size.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of clusters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_identity</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disable_tqdm</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
        <span class="c1"># Run DBScan with increasing eps until there are no clusters bigger than n_max_cluster</span>
        <span class="n">clusters_saved</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">eps_min</span><span class="p">,</span> <span class="n">eps_max</span> <span class="o">+</span> <span class="n">eps_step</span><span class="p">,</span> <span class="n">eps_step</span><span class="p">):</span>
            <span class="n">clustering</span> <span class="o">=</span> <span class="n">DBSCAN</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="n">eps</span><span class="p">,</span> <span class="n">min_samples</span><span class="o">=</span><span class="n">min_samples</span><span class="p">)</span>
            <span class="n">clustering</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">clusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clustering</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
            <span class="n">clusters_counts</span> <span class="o">=</span> <span class="n">clusters</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Check if the largest clusters (without outliers) is not too big</span>
            <span class="k">if</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">clustering_failed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters_counts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n_max_cluster</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clustering_failed</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters_counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">clusters_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">n_max_cluster</span>
            <span class="c1"># If the largest cluster is not too big, save clustering nad continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">clustering_failed</span><span class="p">:</span>
                <span class="n">clusters_saved</span> <span class="o">=</span> <span class="n">clusters</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Save the clusters</span>
        <span class="k">if</span> <span class="n">clusters_saved</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clusters_saved</span><span class="p">[</span><span class="n">clusters_saved</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters_saved</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.initialize_lcg" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_lcg</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the random number generator.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="splits.lcg.Lcg" href="#splits.lcg.Lcg">Lcg</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The random number generator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialize_lcg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Lcg</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the random number generator.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The random number generator.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">Lcg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.modify_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prepares dataframe for splits.</p>
<p>Removes identities specified in <code>self.identity_skip</code> (usually unknown identities).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain columns <code>identity</code> and <code>date</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modified dataframe of the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modify_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepares dataframe for splits.</span>

<span class="sd">    Removes identities specified in `self.identity_skip` (usually unknown identities).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Modified dataframe of the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_skip</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.resplit_by_clusters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resplit_by_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a random re-split of an already existing split.</p>
<p>The re-split is based on clusters which collect similar images.
Then it puts of similar images into the training set.
The rest is randomly split into training and testing sets.
The re-split mimics the split as the training set contains
the same number of samples for EACH individual.
The same goes for the testing set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clusters</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of clusters with the same length as <code>df</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idx_train</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels of the training set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resplit_by_clusters</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">clusters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">    The re-split is based on clusters which collect similar images.</span>
<span class="sd">    Then it puts of similar images into the training set.</span>
<span class="sd">    The rest is randomly split into training and testing sets.</span>
<span class="sd">    The re-split mimics the split as the training set contains</span>
<span class="sd">    the same number of samples for EACH individual.</span>
<span class="sd">    The same goes for the testing set.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">        clusters (np.ndarray): An array of clusters with the same length as `df`.</span>
<span class="sd">        idx_train (np.ndarray): Labels of the training set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Replace clusters appearing just ones with np.nan</span>
    <span class="n">clusters_unique</span><span class="p">,</span> <span class="n">clusters_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">clusters</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">clusters</span><span class="p">,</span> <span class="n">clusters_unique</span><span class="p">[</span><span class="n">clusters_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cluster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clusters</span>

    <span class="c1"># Initialize the random number generator</span>
    <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

    <span class="c1"># Determine how many images of each individual should be in the training set</span>
    <span class="n">identity_train_counts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_train</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

    <span class="c1"># Loop over individuals and create a split for each</span>
    <span class="n">idx_train_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">identity</span><span class="p">,</span> <span class="n">df_identity</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disable_tqdm</span><span class="p">):</span>
        <span class="n">n_train</span> <span class="o">=</span> <span class="n">identity_train_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_identity</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_train</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># All or all but one samples into the training set</span>
            <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_shuffle</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">)</span>
            <span class="n">idx_train_identity</span> <span class="o">=</span> <span class="n">idx_remaining</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Add all the clusters into the training set</span>
            <span class="n">idx_train_identity</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_cluster</span> <span class="ow">in</span> <span class="n">df_identity</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cluster&quot;</span><span class="p">):</span>
                <span class="c1"># Check if the training set is not too big</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_cluster</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n_train</span><span class="p">:</span>
                    <span class="n">idx_train_identity</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_cluster</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

            <span class="c1"># Distribute the remaining indices</span>
            <span class="n">n_train_remaining</span> <span class="o">=</span> <span class="n">n_train</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span>
            <span class="n">idx_remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setdiff</span><span class="p">(</span><span class="n">df_identity</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">idx_train_identity</span><span class="p">)</span>
            <span class="n">idx_remaining</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_shuffle</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">)</span>
            <span class="n">idx_train_identity</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idx_remaining</span><span class="p">[:</span><span class="n">n_train_remaining</span><span class="p">])</span>
        <span class="n">idx_train_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">idx_train_identity</span><span class="p">)</span>
    <span class="n">idx_test_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setdiff</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">idx_train_new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train_new</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test_new</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.resplit_by_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resplit_by_features</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">save_clusters_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a random re-split of an already existing split.</p>
<p>The re-split is based on similarity of features.
It runs DBSCAN as described in <code>compute_clusters</code> and
performs the clustering as described in <code>resplit_by_clusters</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>features</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An array of features with the same length as <code>df</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idx_train</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels of the training set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_clusters_prefix</code>
            </td>
            <td>
                  <code>Optional[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File name prefix for saving clusters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs in <code>compute_clusters</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resplit_by_features</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">save_clusters_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">    The re-split is based on similarity of features.</span>
<span class="sd">    It runs DBSCAN as described in `compute_clusters` and</span>
<span class="sd">    performs the clustering as described in `resplit_by_clusters`.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">        features (np.ndarray): An array of features with the same length as `df`.</span>
<span class="sd">        idx_train (np.ndarray): Labels of the training set.</span>
<span class="sd">        save_clusters_prefix (Optional[bool], optional): File name prefix for saving clusters.</span>
<span class="sd">        **kwargs (type, optional): See kwargs in `compute_clusters`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_clusters_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">save_clusters_prefix</span><span class="si">}</span><span class="s2">.npy&quot;</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resplit_by_clusters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.resplit_random" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resplit_random</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a random re-split of an already existing split.</p>
<p>The re-split mimics the split as the training set contains
the same number of samples for EACH individual.
The same goes for the testing set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain columns <code>identity</code> and <code>date</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idx_train</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels of the training set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idx_test</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels of the testing set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resplit_random</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a random re-split of an already existing split.</span>

<span class="sd">    The re-split mimics the split as the training set contains</span>
<span class="sd">    the same number of samples for EACH individual.</span>
<span class="sd">    The same goes for the testing set.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>
<span class="sd">        idx_train (np.ndarray): Labels of the training set.</span>
<span class="sd">        idx_test (np.ndarray): Labels of the testing set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Initialize the random number generator</span>
    <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

    <span class="c1"># Compute the number of samples for each individual in the training set</span>
    <span class="n">counts_train</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_train</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
        <span class="n">counts_train</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span>
    <span class="c1"># Compute the number of samples for each individual in the testing set</span>
    <span class="n">counts_test</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_test</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
        <span class="n">counts_test</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span>

    <span class="n">idx_train_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx_test_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Loop over all individuals</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
        <span class="c1"># Extract the number of individuals in the training and testing sets</span>
        <span class="n">n_train</span> <span class="o">=</span> <span class="n">counts_train</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="n">counts_test</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">:</span>
                <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The set is too small.&quot;</span><span class="p">))</span>
            <span class="c1"># Get the correct number of indices in both sets</span>
            <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">)</span>
            <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_permutation</span><span class="p">)</span>
            <span class="n">idx_train_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]])</span>
            <span class="n">idx_test_new</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[</span><span class="n">n_train</span> <span class="p">:</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train_new</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test_new</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.set_col_label" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_col_label</span><span class="p">(</span><span class="n">col_label</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sets col_label to desired value</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>col_label</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired value for col_label.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_col_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets col_label to desired value</span>

<span class="sd">    Args:</span>
<span class="sd">        col_label (str): Desired value for col_label.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">col_label</span> <span class="o">=</span> <span class="n">col_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.balanced_split.BalancedSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Splitting method which needs to be implemented by subclasses.</p>
<p>It splits the dataframe <code>df</code> into labels <code>idx_train</code> and <code>idx_test</code>.
The subdataset is obtained by <code>df.loc[idx_train]</code> (not <code>iloc</code>).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of splits. Each split is list of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/balanced_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Splitting method which needs to be implemented by subclasses.</span>

<span class="sd">    It splits the dataframe `df` into labels `idx_train` and `idx_test`.</span>
<span class="sd">    The subdataset is obtained by `df.loc[idx_train]` (not `iloc`).</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="p">(</span>
        <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Subclasses should implement this. </span><span class="se">\n</span><span class="s2"> You may want to use ClosedSetSplit instead of BalancedSplit.&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="identity-split">Identity split</h2>


<div class="doc doc-object doc-class">



<a id="splits.identity_split.IdentitySplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.balanced_split.BalancedSplit" href="#splits.balanced_split.BalancedSplit">BalancedSplit</a></code></p>


        <p>Base class for <code>ClosedSetSplit</code>, <code>OpenSetSplit</code> and <code>DisjointSetSplit</code>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IdentitySplit</span><span class="p">(</span><span class="n">BalancedSplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for `ClosedSetSplit`, `OpenSetSplit` and `DisjointSetSplit`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">general_split</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">individual_train</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">individual_test</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;General-purpose split into the training and testing sets.</span>

<span class="sd">        It puts all samples of `individual_train` into the training set</span>
<span class="sd">        and all samples of `individual_test` into the testing set.</span>
<span class="sd">        The splitting is performed for each individual separately.</span>
<span class="sd">        The split will result in at least one sample in both the training and testing sets.</span>
<span class="sd">        If only one sample is available for an individual, it will be in the training set.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">            individual_train (List[str]): Individuals to be only in the training test.</span>
<span class="sd">            individual_test (List[str]): Individuals to be only in the testing test.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize the random number generator</span>
        <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

        <span class="c1"># Compute how many samples go automatically to the training and testing sets</span>
        <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">n_train</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">individual_train</span><span class="p">])</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">])</span>

        <span class="c1"># Recompute ratio_train and adjust it to proper bounds</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">ratio_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span>
        <span class="k">if</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="n">ratio_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">ratio_train</span> <span class="o">-</span> <span class="n">n_train</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span> <span class="o">-</span> <span class="n">n_train</span><span class="p">)</span>
        <span class="n">ratio_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ratio_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">idx_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">idx_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Make a loop over all individuals</span>
        <span class="k">for</span> <span class="n">individual</span><span class="p">,</span> <span class="n">df_individual</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_train</span> <span class="ow">and</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">:</span>
                <span class="c1"># Check if the class does not belong to both sets</span>
                <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Individual cannot be both in individual_train and individual_test.&quot;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_train</span><span class="p">:</span>
                <span class="c1"># Check if the class does not belong to the training set</span>
                <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">:</span>
                <span class="c1"># Check if the class does not belong to the testing set</span>
                <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise compute the number of samples in the training set</span>
                <span class="n">n_individual</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_individual</span><span class="p">)</span>
                <span class="n">n_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ratio_train</span> <span class="o">*</span> <span class="n">n_individual</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">n_train</span> <span class="o">==</span> <span class="n">n_individual</span> <span class="ow">and</span> <span class="n">n_train</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">n_train</span> <span class="o">-=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">n_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">n_train</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># Create indices to the training set and randomly permute them</span>
                <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_individual</span><span class="p">)</span>
                <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_permutation</span><span class="p">)</span>
                <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]])</span>
                <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[</span><span class="n">n_train</span><span class="p">:]])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.IdentitySplit.general_split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>General-purpose split into the training and testing sets.</p>
<p>It puts all samples of <code>individual_train</code> into the training set
and all samples of <code>individual_test</code> into the testing set.
The splitting is performed for each individual separately.
The split will result in at least one sample in both the training and testing sets.
If only one sample is available for an individual, it will be in the training set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>individual_train</code>
            </td>
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individuals to be only in the training test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>individual_test</code>
            </td>
            <td>
                  <code>List[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individuals to be only in the testing test.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">general_split</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">individual_train</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">individual_test</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;General-purpose split into the training and testing sets.</span>

<span class="sd">    It puts all samples of `individual_train` into the training set</span>
<span class="sd">    and all samples of `individual_test` into the testing set.</span>
<span class="sd">    The splitting is performed for each individual separately.</span>
<span class="sd">    The split will result in at least one sample in both the training and testing sets.</span>
<span class="sd">    If only one sample is available for an individual, it will be in the training set.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>
<span class="sd">        individual_train (List[str]): Individuals to be only in the training test.</span>
<span class="sd">        individual_test (List[str]): Individuals to be only in the testing test.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialize the random number generator</span>
    <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

    <span class="c1"># Compute how many samples go automatically to the training and testing sets</span>
    <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">n_train</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">individual_train</span><span class="p">])</span>
    <span class="n">n_test</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">])</span>

    <span class="c1"># Recompute ratio_train and adjust it to proper bounds</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">ratio_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span>
    <span class="k">if</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">n_train</span> <span class="o">+</span> <span class="n">n_test</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="n">ratio_train</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">ratio_train</span> <span class="o">-</span> <span class="n">n_train</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span> <span class="o">-</span> <span class="n">n_train</span><span class="p">)</span>
    <span class="n">ratio_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ratio_train</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">idx_train</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx_test</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Make a loop over all individuals</span>
    <span class="k">for</span> <span class="n">individual</span><span class="p">,</span> <span class="n">df_individual</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_train</span> <span class="ow">and</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">:</span>
            <span class="c1"># Check if the class does not belong to both sets</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Individual cannot be both in individual_train and individual_test.&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_train</span><span class="p">:</span>
            <span class="c1"># Check if the class does not belong to the training set</span>
            <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individual_test</span><span class="p">:</span>
            <span class="c1"># Check if the class does not belong to the testing set</span>
            <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise compute the number of samples in the training set</span>
            <span class="n">n_individual</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_individual</span><span class="p">)</span>
            <span class="n">n_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">ratio_train</span> <span class="o">*</span> <span class="n">n_individual</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_train</span> <span class="o">==</span> <span class="n">n_individual</span> <span class="ow">and</span> <span class="n">n_train</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">n_train</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">n_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">n_train</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="c1"># Create indices to the training set and randomly permute them</span>
            <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_individual</span><span class="p">)</span>
            <span class="n">idx_permutation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_permutation</span><span class="p">)</span>
            <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]])</span>
            <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_individual</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx_permutation</span><span class="p">[</span><span class="n">n_train</span><span class="p">:]])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="closed-set-split">Closed-set split</h2>


<div class="doc doc-object doc-class">



<a id="splits.identity_split.ClosedSetSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.identity_split.IdentitySplit" href="#splits.identity_split.IdentitySplit">IdentitySplit</a></code></p>


        <p>Closed-set splitting method into training and testing sets.</p>
<p>All individuals are both in the training and testing set.
The only exception is that individuals with only one sample are in the training set.
Implementation of <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ClosedSetSplit</span><span class="p">(</span><span class="n">IdentitySplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Closed-set splitting method into training and testing sets.</span>

<span class="sd">    All individuals are both in the training and testing set.</span>
<span class="sd">    The only exception is that individuals with only one sample are in the training set.</span>
<span class="sd">    Implementation of [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio_train</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">        Args:</span>
<span class="sd">            ratio_train (float): *Approximate* size of the training set.</span>
<span class="sd">            **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="n">ratio_train</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.ClosedSetSplit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ratio_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ratio_train</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>Approximate</em> size of the training set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs <code>seed</code>, <code>identity_skip</code> and <code>col_label</code> of the parent class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio_train</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">    Args:</span>
<span class="sd">        ratio_train (float): *Approximate* size of the training set.</span>
<span class="sd">        **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="n">ratio_train</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.ClosedSetSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Implementation of the <a href="../reference_splits#splits.balanced_split.BalancedSplit.split">base splitting method</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of splits. Each split is list of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="open-set-split">Open-set split</h2>


<div class="doc doc-object doc-class">



<a id="splits.identity_split.OpenSetSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.identity_split.IdentitySplit" href="#splits.identity_split.IdentitySplit">IdentitySplit</a></code></p>


        <p>Open-set splitting method into training and testing sets.</p>
<p>Some individuals are in the testing but not in the training set.
Implementation of <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OpenSetSplit</span><span class="p">(</span><span class="n">IdentitySplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open-set splitting method into training and testing sets.</span>

<span class="sd">    Some individuals are in the testing but not in the training set.</span>
<span class="sd">    Implementation of [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ratio_train</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">ratio_class_test</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_class_test</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">open_in_test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">        The user must provide exactly one from `ratio_class_test` and `n_class_test`.</span>
<span class="sd">        The latter specifies the number of individuals to be only in the testing set.</span>
<span class="sd">        The former specified the ratio of samples of individuals (not individuals themselves)</span>
<span class="sd">        to be only in the testing set.</span>

<span class="sd">        Args:</span>
<span class="sd">            ratio_train (float): *Approximate* size of the training set.</span>
<span class="sd">            ratio_class_test (float, optional): *Approximate* ratio of samples of individuals only in the testing set.</span>
<span class="sd">            n_class_test (int, optional): Number of individuals only in the testing set.</span>
<span class="sd">            open_in_test (str, optional): Whether the unique identifies will be in test (default) or train set.</span>
<span class="sd">            **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Either ratio_class_test or n_class_test must be provided.&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only ratio_class_test or n_class_test can be provided.&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="n">ratio_train</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span> <span class="o">=</span> <span class="n">ratio_class_test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="o">=</span> <span class="n">n_class_test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_in_test</span> <span class="o">=</span> <span class="n">open_in_test</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Initialize the random number generator</span>
        <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

        <span class="c1"># Compute the counts and randomly permute them</span>
        <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">n_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_class</span><span class="p">)</span>
        <span class="n">y_counts</span> <span class="o">=</span> <span class="n">y_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># Compute number of identities in the testing set</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">n_class_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_class_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span>

        <span class="c1"># Specify individuals going purely into training and testing sets</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_test</span><span class="p">:</span>
            <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
            <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.OpenSetSplit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ratio_train</span><span class="p">,</span> <span class="n">ratio_class_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_class_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">open_in_test</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class.</p>
<p>The user must provide exactly one from <code>ratio_class_test</code> and <code>n_class_test</code>.
The latter specifies the number of individuals to be only in the testing set.
The former specified the ratio of samples of individuals (not individuals themselves)
to be only in the testing set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ratio_train</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>Approximate</em> size of the training set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ratio_class_test</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>Approximate</em> ratio of samples of individuals only in the testing set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_class_test</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of individuals only in the testing set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>open_in_test</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the unique identifies will be in test (default) or train set.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs <code>seed</code>, <code>identity_skip</code> and <code>col_label</code> of the parent class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ratio_train</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">ratio_class_test</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_class_test</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">open_in_test</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">    The user must provide exactly one from `ratio_class_test` and `n_class_test`.</span>
<span class="sd">    The latter specifies the number of individuals to be only in the testing set.</span>
<span class="sd">    The former specified the ratio of samples of individuals (not individuals themselves)</span>
<span class="sd">    to be only in the testing set.</span>

<span class="sd">    Args:</span>
<span class="sd">        ratio_train (float): *Approximate* size of the training set.</span>
<span class="sd">        ratio_class_test (float, optional): *Approximate* ratio of samples of individuals only in the testing set.</span>
<span class="sd">        n_class_test (int, optional): Number of individuals only in the testing set.</span>
<span class="sd">        open_in_test (str, optional): Whether the unique identifies will be in test (default) or train set.</span>
<span class="sd">        **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Either ratio_class_test or n_class_test must be provided.&quot;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only ratio_class_test or n_class_test can be provided.&quot;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="n">ratio_train</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span> <span class="o">=</span> <span class="n">ratio_class_test</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="o">=</span> <span class="n">n_class_test</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">open_in_test</span> <span class="o">=</span> <span class="n">open_in_test</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.OpenSetSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Implementation of the <a href="../reference_splits#splits.balanced_split.BalancedSplit.split">base splitting method</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of splits. Each split is list of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Initialize the random number generator</span>
    <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

    <span class="c1"># Compute the counts and randomly permute them</span>
    <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">n_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_class</span><span class="p">)</span>
    <span class="n">y_counts</span> <span class="o">=</span> <span class="n">y_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Compute number of identities in the testing set</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n_class_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_class_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span>

    <span class="c1"># Specify individuals going purely into training and testing sets</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_in_test</span><span class="p">:</span>
        <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
        <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="disjoint-set-split">Disjoint-set split</h2>


<div class="doc doc-object doc-class">



<a id="splits.identity_split.DisjointSetSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.identity_split.IdentitySplit" href="#splits.identity_split.IdentitySplit">IdentitySplit</a></code></p>


        <p>Disjoint-set splitting method into training and testing sets.</p>
<p>No individuals are in both the training and testing sets.
Implementation of <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DisjointSetSplit</span><span class="p">(</span><span class="n">IdentitySplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Disjoint-set splitting method into training and testing sets.</span>

<span class="sd">    No individuals are in both the training and testing sets.</span>
<span class="sd">    Implementation of [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio_class_test</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_class_test</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">        The user must provide exactly one from `ratio_class_test` and `n_class_test`.</span>
<span class="sd">        The latter specifies the number of individuals to be only in the testing set.</span>
<span class="sd">        The former specified the ratio of samples of individuals (not individuals themselves)</span>
<span class="sd">        to be only in the testing set.</span>

<span class="sd">        Args:</span>
<span class="sd">            ratio_class_test (float, optional): *Approximate* ratio of samples of individuals only in the testing set.</span>
<span class="sd">            n_class_test (int, optional): Number of individuals only in the testing set.</span>
<span class="sd">            **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Either ratio_class_test or n_class_test must be provided.&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only ratio_class_test or n_class_test can be provided.&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Arbitrary value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span> <span class="o">=</span> <span class="n">ratio_class_test</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="o">=</span> <span class="n">n_class_test</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Initialize the random number generator</span>
        <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

        <span class="c1"># Compute the counts and randomly permute them</span>
        <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">n_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_class</span><span class="p">)</span>
        <span class="n">y_counts</span> <span class="o">=</span> <span class="n">y_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="c1"># Compute number of identities in the testing set</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">n_class_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_class_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span>

        <span class="c1"># Specify individuals going purely into training and testing sets</span>
        <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">n_class_test</span><span class="p">:])</span>
        <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.DisjointSetSplit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ratio_class_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_class_test</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class.</p>
<p>The user must provide exactly one from <code>ratio_class_test</code> and <code>n_class_test</code>.
The latter specifies the number of individuals to be only in the testing set.
The former specified the ratio of samples of individuals (not individuals themselves)
to be only in the testing set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ratio_class_test</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>Approximate</em> ratio of samples of individuals only in the testing set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_class_test</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of individuals only in the testing set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs <code>seed</code>, <code>identity_skip</code> and <code>col_label</code> of the parent class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio_class_test</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_class_test</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">    The user must provide exactly one from `ratio_class_test` and `n_class_test`.</span>
<span class="sd">    The latter specifies the number of individuals to be only in the testing set.</span>
<span class="sd">    The former specified the ratio of samples of individuals (not individuals themselves)</span>
<span class="sd">    to be only in the testing set.</span>

<span class="sd">    Args:</span>
<span class="sd">        ratio_class_test (float, optional): *Approximate* ratio of samples of individuals only in the testing set.</span>
<span class="sd">        n_class_test (int, optional): Number of individuals only in the testing set.</span>
<span class="sd">        **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Either ratio_class_test or n_class_test must be provided.&quot;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">ratio_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_class_test</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only ratio_class_test or n_class_test can be provided.&quot;</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ratio_train</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Arbitrary value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span> <span class="o">=</span> <span class="n">ratio_class_test</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="o">=</span> <span class="n">n_class_test</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.identity_split.DisjointSetSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Implementation of the <a href="../reference_splits#splits.balanced_split.BalancedSplit.split">base splitting method</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain column <code>identity</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of splits. Each split is list of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/identity_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain column `identity`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Initialize the random number generator</span>
    <span class="n">lcg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize_lcg</span><span class="p">()</span>

    <span class="c1"># Compute the counts and randomly permute them</span>
    <span class="n">y_counts</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">n_class</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">lcg</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="n">n_class</span><span class="p">)</span>
    <span class="n">y_counts</span> <span class="o">=</span> <span class="n">y_counts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Compute number of identities in the testing set</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ratio_class_test</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n_class_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">y_counts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_class_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_class_test</span>

    <span class="c1"># Specify individuals going purely into training and testing sets</span>
    <span class="n">individual_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">n_class_test</span><span class="p">:])</span>
    <span class="n">individual_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">n_class_test</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">general_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">individual_train</span><span class="p">,</span> <span class="n">individual_test</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="time-aware-split">Time-aware split</h2>


<div class="doc doc-object doc-class">



<a id="splits.time_aware_split.TimeAwareSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.balanced_split.BalancedSplit" href="#splits.balanced_split.BalancedSplit">BalancedSplit</a></code></p>


        <p>Base class for <code>TimeProportionSplit</code> and <code>TimeCutoffSplit</code>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimeAwareSplit</span><span class="p">(</span><span class="n">BalancedSplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for `TimeProportionSplit` and `TimeCutoffSplit`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">modify_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares dataframe for splits.</span>

<span class="sd">        Removes identities specified in `self.identity_skip` (usually unknown identities).</span>
<span class="sd">        Convert the `date` column into a unified format.</span>
<span class="sd">        Add the `year` column.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Modified dataframe of the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Check if the DataFrame contain the column date.</span>
        <span class="k">if</span> <span class="s2">&quot;date&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Dataframe df does not contain column date.&quot;</span><span class="p">))</span>

        <span class="c1"># Remove identities to be skipped</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_skip</span><span class="p">]</span>

        <span class="c1"># Removes entries without dates</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

        <span class="c1"># Convert date to datetime format (from possibly strings) and drop hours</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.time_aware_split.TimeAwareSplit.modify_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prepares dataframe for splits.</p>
<p>Removes identities specified in <code>self.identity_skip</code> (usually unknown identities).
Convert the <code>date</code> column into a unified format.
Add the <code>year</code> column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain columns <code>identity</code> and <code>date</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Modified dataframe of the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modify_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepares dataframe for splits.</span>

<span class="sd">    Removes identities specified in `self.identity_skip` (usually unknown identities).</span>
<span class="sd">    Convert the `date` column into a unified format.</span>
<span class="sd">    Add the `year` column.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Modified dataframe of the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if the DataFrame contain the column date.</span>
    <span class="k">if</span> <span class="s2">&quot;date&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Dataframe df does not contain column date.&quot;</span><span class="p">))</span>

    <span class="c1"># Remove identities to be skipped</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_skip</span><span class="p">]</span>

    <span class="c1"># Removes entries without dates</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

    <span class="c1"># Convert date to datetime format (from possibly strings) and drop hours</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="time-proportion-split">Time-proportion split</h2>


<div class="doc doc-object doc-class">



<a id="splits.time_aware_split.TimeProportionSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.time_aware_split.TimeAwareSplit" href="#splits.time_aware_split.TimeAwareSplit">TimeAwareSplit</a></code></p>


        <p>Time-proportion non-random splitting method into training and testing sets.</p>
<p>For each individual, it extracts unique observation dates
and puts half to the training to the testing set.
Ignores individuals with only one observation date.
Implementation of <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimeProportionSplit</span><span class="p">(</span><span class="n">TimeAwareSplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Time-proportion non-random splitting method into training and testing sets.</span>

<span class="sd">    For each individual, it extracts unique observation dates</span>
<span class="sd">    and puts half to the training to the testing set.</span>
<span class="sd">    Ignores individuals with only one observation date.</span>
<span class="sd">    Implementation of [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">        Args:</span>
<span class="sd">            ratio (float, optional): The fraction of dates going to the training set.</span>
<span class="sd">            **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">idx_train</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">idx_test</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over all identities; x is a tuple (identity, df with unique identity)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
            <span class="n">dates</span> <span class="o">=</span> <span class="n">df_name</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
            <span class="n">n_dates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_dates</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Loop over all dates; y is a tuple (date, df with unique date and identity)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">df_date</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dates</span><span class="p">):</span>
                    <span class="c1"># Add half dates to the training and half to the testing set</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">n_dates</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="o">*</span> <span class="n">n_dates</span><span class="p">))):</span>
                        <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.time_aware_split.TimeProportionSplit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ratio</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fraction of dates going to the training set.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs <code>seed</code>, <code>identity_skip</code> and <code>col_label</code> of the parent class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">    Args:</span>
<span class="sd">        ratio (float, optional): The fraction of dates going to the training set.</span>
<span class="sd">        **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="o">=</span> <span class="n">ratio</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.time_aware_split.TimeProportionSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Implementation of the <a href="../reference_splits#splits.balanced_split.BalancedSplit.split">base splitting method</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain columns <code>identity</code> and <code>date</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of splits. Each split is list of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of splits. Each split is list of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">idx_train</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idx_test</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Loop over all identities; x is a tuple (identity, df with unique identity)</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">df_name</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_label</span><span class="p">):</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="n">df_name</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span>
        <span class="n">n_dates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_dates</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Loop over all dates; y is a tuple (date, df with unique date and identity)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">df_date</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dates</span><span class="p">):</span>
                <span class="c1"># Add half dates to the training and half to the testing set</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">n_dates</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ratio</span> <span class="o">*</span> <span class="n">n_dates</span><span class="p">))):</span>
                    <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">idx_test</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_date</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx_train</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_name</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_train</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_test</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="time-cutoff-split">Time-cutoff split</h2>


<div class="doc doc-object doc-class">



<a id="splits.time_aware_split.TimeCutoffSplit"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="splits.time_aware_split.TimeAwareSplit" href="#splits.time_aware_split.TimeAwareSplit">TimeAwareSplit</a></code></p>


        <p>Time-cutoff non-random splitting method into training and testing sets.</p>
<p>Puts all individuals observed before <code>year</code> into the training test.
Puts all individuals observed during <code>year</code> into the testing test.
Ignores all individuals observed after <code>year</code>.
Implementation of <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimeCutoffSplit</span><span class="p">(</span><span class="n">TimeAwareSplit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Time-cutoff non-random splitting method into training and testing sets.</span>

<span class="sd">    Puts all individuals observed before `year` into the training test.</span>
<span class="sd">    Puts all individuals observed during `year` into the testing test.</span>
<span class="sd">    Ignores all individuals observed after `year`.</span>
<span class="sd">    Implementation of [this paper](https://arxiv.org/abs/2211.10307).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">test_one_year_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">        Args:</span>
<span class="sd">            year (int): Splitting year.</span>
<span class="sd">            test_one_year_only (bool, optional): Whether the test set is `df[&#39;year&#39;] == year` or `df[&#39;year&#39;] &gt;= year`.</span>
<span class="sd">            **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_one_year_only</span> <span class="o">=</span> <span class="n">test_one_year_only</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of labels of the training and testing sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">idx_train</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_one_year_only</span><span class="p">:</span>
            <span class="n">idx_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="n">idx_train</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="n">idx_test</span><span class="p">])]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.time_aware_split.TimeCutoffSplit.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">test_one_year_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>year</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Splitting year.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_one_year_only</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the test set is <code>df['year'] == year</code> or <code>df['year'] &gt;= year</code>.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See kwargs <code>seed</code>, <code>identity_skip</code> and <code>col_label</code> of the parent class.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">test_one_year_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the class.</span>

<span class="sd">    Args:</span>
<span class="sd">        year (int): Splitting year.</span>
<span class="sd">        test_one_year_only (bool, optional): Whether the test set is `df[&#39;year&#39;] == year` or `df[&#39;year&#39;] &gt;= year`.</span>
<span class="sd">        **kwargs (type, optional): See kwargs `seed`, `identity_skip` and `col_label` of the parent class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">test_one_year_only</span> <span class="o">=</span> <span class="n">test_one_year_only</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.time_aware_split.TimeCutoffSplit.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Implementation of the <a href="../reference_splits#splits.balanced_split.BalancedSplit.split">base splitting method</a>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dataframe of the data. It must contain columns <code>identity</code> and <code>date</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list[tuple[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of the training and testing sets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/time_aware_split.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of the [base splitting method](../reference_splits#splits.balanced_split.BalancedSplit.split).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of the data. It must contain columns `identity` and `date`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of the training and testing sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">idx_train</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_one_year_only</span><span class="p">:</span>
        <span class="n">idx_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">idx_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="n">idx_train</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="n">idx_test</span><span class="p">])]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="lcg">Lcg</h2>


<div class="doc doc-object doc-class">



<a id="splits.lcg.Lcg"></a>
    <div class="doc doc-contents first">


        <p>Linear congruential generator for generating random numbers.</p>
<p>Copied from <a href="https://stackoverflow.com/questions/18634079/glibc-rand-function-implementation">StackOverflow</a>.
It is machine-, distribution- and package version-independent.
It has some drawbacks (check the link above) but perfectly sufficient for our application.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="splits.lcg.Lcg.state">state</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random state of the LCG.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>wildlife_datasets/splits/lcg.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Lcg</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear congruential generator for generating random numbers.</span>

<span class="sd">    Copied from [StackOverflow](https://stackoverflow.com/questions/18634079/glibc-rand-function-implementation).</span>
<span class="sd">    It is machine-, distribution- and package version-independent.</span>
<span class="sd">    It has some drawbacks (check the link above) but perfectly sufficient for our application.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      state (int): Random state of the LCG.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">iterate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialization function for LCG.</span>

<span class="sd">        Args:</span>
<span class="sd">            seed (int): Initial random seed.</span>
<span class="sd">            iterate (int, optional): Number of initial random iterations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterate</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a new random integer from the current state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New random integer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">*</span> <span class="mi">1103515245</span> <span class="o">+</span> <span class="mi">12345</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7FFFFFFF</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>

    <span class="k">def</span> <span class="nf">random_permutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a random permutation of `range(n)`.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): Length of the sequence to be permuted.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Permuted sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rnd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
            <span class="n">rnd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">random_shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a random shuffle of `x`.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (np.ndarray): Array to be permuted.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Shuffled array.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="splits.lcg.Lcg.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">iterate</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialization function for LCG.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial random seed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iterate</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of initial random iterations.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/lcg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">iterate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization function for LCG.</span>

<span class="sd">    Args:</span>
<span class="sd">        seed (int): Initial random seed.</span>
<span class="sd">        iterate (int, optional): Number of initial random iterations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterate</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.lcg.Lcg.random" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a new random integer from the current state.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New random integer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/lcg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a new random integer from the current state.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New random integer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">*</span> <span class="mi">1103515245</span> <span class="o">+</span> <span class="mi">12345</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7FFFFFFF</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.lcg.Lcg.random_permutation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_permutation</span><span class="p">(</span><span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a random permutation of <code>range(n)</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of the sequence to be permuted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Permuted sequence.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/lcg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_permutation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a random permutation of `range(n)`.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int): Length of the sequence to be permuted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Permuted sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rnd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">rnd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rnd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="splits.lcg.Lcg.random_shuffle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a random shuffle of <code>x</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array to be permuted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shuffled array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>wildlife_datasets/splits/lcg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a random shuffle of `x`.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.ndarray): Array to be permuted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Shuffled array.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">random_permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>