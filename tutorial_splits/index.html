
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../default_splits/">
      
      
        <link rel="next" href="../dataframe/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Advanced splits - Wildlife Datasets</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-use-splitting-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Wildlife Datasets" class="md-header__button md-logo" aria-label="Wildlife Datasets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wildlife Datasets
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Advanced splits
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/WildlifeDatasets/wildlife-datasets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-datasets
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Wildlife Datasets" class="md-nav__button md-logo" aria-label="Wildlife Datasets" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Wildlife Datasets
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/WildlifeDatasets/wildlife-datasets" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-datasets
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Oveview of datasets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing ML methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../recommended/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recommended datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../default_splits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default splits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Advanced
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Advanced splits
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Advanced splits
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#splits-based-on-identities" class="md-nav__link">
    <span class="md-ellipsis">
      Splits based on identities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splits based on identities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#closed-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Closed-set split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Open-set split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disjoint-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Disjoint-set split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splits-based-on-time" class="md-nav__link">
    <span class="md-ellipsis">
      Splits based on time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splits based on time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-proportion-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-proportion split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-cutoff-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-cutoff split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-resplit" class="md-nav__link">
    <span class="md-ellipsis">
      Random resplit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset representation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding new datasets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Dataset preprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Dataset preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_splits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Splits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#splits-based-on-identities" class="md-nav__link">
    <span class="md-ellipsis">
      Splits based on identities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splits based on identities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#closed-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Closed-set split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Open-set split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disjoint-set-split" class="md-nav__link">
    <span class="md-ellipsis">
      Disjoint-set split
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splits-based-on-time" class="md-nav__link">
    <span class="md-ellipsis">
      Splits based on time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Splits based on time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#time-proportion-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-proportion split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-cutoff-split" class="md-nav__link">
    <span class="md-ellipsis">
      Time-cutoff split
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-resplit" class="md-nav__link">
    <span class="md-ellipsis">
      Random resplit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p></p>
<p></p>
<h1 id="how-to-use-splitting-functions">How to use splitting functions</h1>
<p>The crucial part of machine learning is training a method on a training set and evaluating it on a separate testing set. We provide a default split for each dataset. However, it is possible to create additional custom splits. The following splits are implemented:</p>
<ul>
<li><strong>closed-set split</strong>. The default split where the testing set does not contain any new individuals. For each sample from the testing set, the goal is to assign some individual from the training set. The name follows from the fact that the population is closed.</li>
<li><strong>open-set split</strong>. The split where the testing set contains new individuals. For each sample from the testing set, the goal is to assign some individual from the training set or predict that the sample contain a new individual. The name follows from the fact that the population is open.</li>
<li><strong>disjoint-set split</strong>. The split where there are no individuals in both the training and testing sets. For each sample from the testing set, the goal is to assign some individual from the testing set. The name follows from the fact that the two populations are disjoint.</li>
</ul>
<p>The splits are usually created randomly but in situations where the dataset contains timestamps, it is also possible to create the split based on timestamps. Due to our representation of the <a href="../reference_splits/#lcg">random number generator</a>, the splits are both machine- and system-independent. We followed the presentation from <a href="https://arxiv.org/abs/2211.10307">this paper</a>.</p>
<p>We assume that we have already <a href="../tutorial_datasets/#downloading-datasets">downloaded</a> the MacaqueFaces dataset. Then we load the dataset and the dataframe.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">wildlife_datasets</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">splits</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">MacaqueFaces</span><span class="p">(</span><span class="s1">&#39;data/MacaqueFaces&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">df</span>
</code></pre></div>
<h2 id="splits-based-on-identities">Splits based on identities</h2>
<p>Splits on identities perform the split for each individual separetely. All these splits are random.</p>
<h3 id="closed-set-split">Closed-set split</h3>
<p>The most common split is the closed-set split, where each individual has samples in both the training and testing sets.</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">ClosedSetSplit</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 5024/1256/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 80.00%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<p>This code generates a split, where the training set contains approximately 80% of all samples. Even though this split contains precisely 80%, since the split is done separately for each individual, the real ratio of the training set may be different. The outputs of the spliller are labels, not indices, and, therefore, we access the training and testing sets by</p>
<div class="highlight"><pre><span></span><code><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_train</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx_test</span><span class="p">]</span>
</code></pre></div>
<h3 id="open-set-split">Open-set split</h3>
<p>In the open-set split, there are some individuals with all their samples only in the testing set. For the remaining individuals, the closed-set split is performed.</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">OpenSetSplit</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware open-set</span>
<span class="go">Samples: train/test/unassigned/total = 5028/1252/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 30/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/760</span>
<span class="go">Classes: train only/test only/joint  = 0/4/30</span>

<span class="go">Fraction of train set     = 80.06%</span>
<span class="go">Fraction of test set only = 12.10%</span>
</code></pre></div>
<p>This code generates a split, where approximately 10% of samples are put directly into the testing set. It also specifies that the training set should contain 50% of all samples. As in the previous (and all following) cases, the numbers are only approximate with the actual ratios being 8.92% and 80%. The other possibility to create this split is to prescribe the number of individuals (instead of ratio of samples) which go directly into the testing set.</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">OpenSetSplit</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">n_class_test</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware open-set</span>
<span class="go">Samples: train/test/unassigned/total = 5025/1255/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 29/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/940</span>
<span class="go">Classes: train only/test only/joint  = 0/5/29</span>

<span class="go">Fraction of train set     = 80.02%</span>
<span class="go">Fraction of test set only = 14.97%</span>
</code></pre></div>
<h3 id="disjoint-set-split">Disjoint-set split</h3>
<p>For the disjoint-set split, each individual has all samples either in the training or testing set but never in both. Similarly as in the open-set split, we can create the split either by</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">DisjointSetSplit</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware disjoint-set</span>
<span class="go">Samples: train/test/unassigned/total = 4980/1300/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 27/7/0/34</span>
<span class="go">Samples: train only/test only        = 4980/1300</span>
<span class="go">Classes: train only/test only/joint  = 27/7/0</span>

<span class="go">Fraction of train set     = 79.30%</span>
<span class="go">Fraction of test set only = 20.70%</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">DisjointSetSplit</span><span class="p">(</span><span class="n">n_class_test</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware disjoint-set</span>
<span class="go">Samples: train/test/unassigned/total = 4420/1860/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 24/10/0/34</span>
<span class="go">Samples: train only/test only        = 4420/1860</span>
<span class="go">Classes: train only/test only/joint  = 24/10/0</span>

<span class="go">Fraction of train set     = 70.38%</span>
<span class="go">Fraction of test set only = 29.62%</span>
</code></pre></div>
<p>The first method put approximately 20% of the samples to the testing set, while the second method puts 10 classes to the testing set.</p>
<h2 id="splits-based-on-time">Splits based on time</h2>
<p>Splits based on time create some cutoff time and put everything before the cutoff time into the training set and everything after the cutoff time into the training set. Therefore, this splits are not random but deterministic. These splits also ignore all samples without timestamps.</p>
<h3 id="time-proportion-split">Time-proportion split</h3>
<p>Time-proportion split counts on how many days was each individual observed. Then it puts all samples corresponding to the first half of the observation days to the training set and all remaining to the testing set. It ignores all individuals observed only on one day. Since all individuals are both in the training and testing set, it leads to the closed-set split.</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">TimeProportionSplit</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-proportion closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 3731/2549/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 59.41%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<p>Even though the split is non-random, it still required the seed because of the <a href="#random-resplit">random resplit</a>.</p>
<h3 id="time-cutoff-split">Time-cutoff split</h3>
<p>While the time-proportion day selected a different cutoff day for each individual, the time-cutoff split creates one cutoff year for the whole dataset. All samples taken before the cutoff year go the training set, while all samples taken during the cutoff year go to the testing set. Since some individuals may be present only in the testing set, this split is usually an open-set split.</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">TimeCutoffSplit</span><span class="p">(</span><span class="mi">2015</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-cutoff closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 3745/2535/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 59.63%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<p>It is also possible to place all samples taken during or after the cutoff year to the testing set by</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">TimeCutoffSplit</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="n">test_one_year_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-cutoff closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 3745/2535/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 59.63%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<p>It is also possible to create all possible time-cutoff splits for different years by</p>
<div class="highlight"><pre><span></span><code><span class="n">splitter</span> <span class="o">=</span> <span class="n">splits</span><span class="o">.</span><span class="n">TimeCutoffSplitAll</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="ow">in</span> <span class="n">splitter</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-cutoff closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 3745/2535/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 59.63%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<h3 id="random-resplit">Random resplit</h3>
<p>Since the splits based on time are not random, it is also possible to create similar random splits by </p>
<div class="highlight"><pre><span></span><code><span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">resplit_random</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
<span class="n">splits</span><span class="o">.</span><span class="n">analyze_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="go">Split: time-unaware closed-set</span>
<span class="go">Samples: train/test/unassigned/total = 3745/2535/0/6280</span>
<span class="go">Classes: train/test/unassigned/total = 34/34/0/34</span>
<span class="go">Samples: train only/test only        = 0/0</span>
<span class="go">Classes: train only/test only/joint  = 0/0/34</span>

<span class="go">Fraction of train set     = 59.63%</span>
<span class="go">Fraction of test set only = 0.00%</span>
</code></pre></div>
<p>For each individual the number of samples in the training set will be the same for the original and new splits. Since the new splits are random, they do not utilize the time at all.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>